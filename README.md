# mkunion
Improves work with unions in golang by generating beautiful code (in other languages referred as sum types, variants, discriminators, tagged unions)

## Usage
Make sure that you have installed mkunion and is in GOPATH/bin
```bash
go install github.com/widmogrod/mkunion
```

Create your first union
```go
package example

//go:generate mkunion -name=Vehicle -types=Plane,Car,Boat -path=simple_union_example_gen_test -packageName=example
type (
    Car   struct{}
    Plane struct{}
    Boat  struct{}
)
```

Generated code will look like
```go
// Code generated by govisitor. DO NOT EDIT.
package example

type VehicleVisitor interface {
	VisitPlane(v *Plane) any
	VisitCar(v *Car) any
	VisitBoat(v *Boat) any
}

type Vehicle interface {
	Accept(g VehicleVisitor) any
}

func (r *Plane) Accept(v VehicleVisitor) any { return v.VisitPlane(r) }
func (r *Car) Accept(v VehicleVisitor) any { return v.VisitCar(r) }
func (r *Boat) Accept(v VehicleVisitor) any { return v.VisitBoat(r) }

var (
	_ Vehicle = (*Plane)(nil)
	_ Vehicle = (*Car)(nil)
	_ Vehicle = (*Boat)(nil)
)

type VehicleOneOf struct {
	Plane *Plane `json:",omitempty"`
	Car *Car `json:",omitempty"`
	Boat *Boat `json:",omitempty"`
}

func (r *VehicleOneOf) Accept(v VehicleVisitor) any {
	switch {
	case r.Plane != nil:
		return v.VisitPlane(r.Plane)
	case r.Car != nil:
		return v.VisitCar(r.Car)
	case r.Boat != nil:
		return v.VisitBoat(r.Boat)
	default:
		panic("unexpected")
	}
}

var _ Vehicle = (*VehicleOneOf)(nil)

type mapVehicleToOneOf struct{}

func (t *mapVehicleToOneOf) VisitPlane(v *Plane) any { return &VehicleOneOf{Plane: v} }
func (t *mapVehicleToOneOf) VisitCar(v *Car) any { return &VehicleOneOf{Car: v} }
func (t *mapVehicleToOneOf) VisitBoat(v *Boat) any { return &VehicleOneOf{Boat: v} }

var defaultMapVehicleToOneOf VehicleVisitor = &mapVehicleToOneOf{}

func MapVehicleToOneOf(v Vehicle) *VehicleOneOf {
	return v.Accept(defaultMapVehicleToOneOf).(*VehicleOneOf)
}
```

## Development
```
go generate ./...
go test ./...
```